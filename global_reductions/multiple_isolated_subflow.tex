\newcommand{\MISR}{\mathsf{MISR}}

With the operator $\ISR$ we can produce weakly streamilend derivations with respect to one atom at a time, with the operator $\PB$ we can produce weakly streamlined derivations with respect to two dual atoms in parallel. In this section we see an operator, $\MISR_n$, for every $n>0$, which is a generalisation of $\ISR$, that can produce a weakly streamlined derivation with respect to $n$ number of atoms in parallel, as long as they are pairwise non-dual.

We will see later how a derivation containing $2n$ atoms can be weakly streamlined by two applications of $\Simpl$ and two applications of $\MISR_n$.

The operator is defined in terms of the following flow reduction. Unlike the flow reductions of the preceding sections, we present here a reduction which depends on several parameters. It is important to note that these parameters are independent of the derivation to which we later apply the operator. In order to perform streamlining on an arbitrary number of atoms in parallel, we need find a class of atomic flows, $\eta_k$, which are used as a sort of sharing mechanism. We are at this stage not able to describe the flows $\eta_k$ without relying on their corresponding derivations. For this reason, it might help the understanding of Definition~\vref{definition:MultipleIsolatedSubflowsRemoval} to refer to the derivation given in the proof of Theorem~\vref{theorem:SoundMultipleIsolatedSubflowsRemoval}.

\newcommand{\Ord}[1]{{\mathsf O}(#1)}

In Subsection~\vref{subsection:ThresholdFormulae}, we present one possible combination of valid parameters, which yields quasipolynomial (\emph{i.e.} $n^{\Ord{\log n}}$) streamlining. We conjecture that by finding different parameters we will be able to obtain more efficient versions of this reduction. In particular, we hope to be able to obtain polynomial streamlining.

\newcommand{\Gammasf}{\mathsf\Gamma}
%----------------------------------
\newcommand{\frmis}{{\mathsf{mis}}}
\begin{definition}\label{definition:MultipleIsolatedSubflowsRemoval}
For every $n>0$, given
\begin{itemize}
\item atoms $a_1$, $\dots$, $a_n$;
\item an $N>0$;
\item for $0\le k\le N$, formulae $\gamma_{k,1}$, $\dots$, $\gamma_{k,n}$, such that
\begin{itemize}
 \item $\gamma_{0,1}=\cdots=\gamma_{0,n}=\ttt$, and
 \item $\gamma_{N,1}=\cdots=\gamma_{N,n}=\fff$; and
\end{itemize}
\item for $1\le k\le N$, a derivation
\[
\Gammasf_k\quad=\quad
\vlder{}{\SKS\setminus\{\aid,\aiu\}}
{
 \vls([a_1.\gamma_{k,1}].\cdots.[a_n.\gamma_{k,n}])
}
{
 \vls[(a_1.\gamma_{k-1,1}).\cdots.(a_n.\gamma_{k-1,n})]
}\quad,
\]
\end{itemize}
let, for $1\le k\le N$, $\eta_k$ be the flow of\/ $\Gammasf_k$, and let
\[
\mu_k\;=\;
\vcenter{\hbox{\includegraphics{Figures/redMISRAux}}}
\quad,
\]
where, for $1\le i\le n$, $l_i$ is the number of atom occurrences in $\gamma_{k,i}$, we define the reduction $\to_{\frmis_n}$ (where $\frmis$ stands for \emph{multiple isolated subflows}\index{Multiple Isolated Subflows Remover!reduction}) as follows, for any flow $\phi$ and any connected components $\psi_1$, $\dots$, $\psi_n$ that do not contain interaction or cut vertices:
\[
\vcenter{\hbox{\includegraphics{Figures/redMISRRedex}}}
\quad\to_{\frmis_n}\quad
\vcenter{\hbox{\includegraphics{Figures/redMISRContractum}}}
\quad,
\]
where we call the evidenced interaction (resp., cut) vertices $\nu_{\aid,1}$, $\dots$, $\nu_{\aid,n}$ (resp., $\nu_{\aiu,1}$, $\dots$, $\nu_{\aiu,n}$).
\end{definition}
%---------------

\begin{remark}
The reduction ${\to_{\frmis_n}}$ is denoted as if it only depends on $n$, this is a misuse of notation, and we will take it for granted that we also have the other parameters whenever we write ${\to_{\frmis_n}}$.
\end{remark}

%--------------------------------------------------------------
\begin{remark}\label{remark:BaseMultipleIsolatedSubflowRemoval}
If $N=1$ and
$
\Gammasf_1=\;
\vlinf{=}{}
{
 \vls[a_1.\fff]
}
{
 \vls(a_1.\ttt)
}\;,
$
then ${\to_{\frmis_1}}={\to_\fris}$.
\end{remark}
%-----------

%------------------------------------------------------------------
\begin{theorem}\label{theorem:SoundMultipleIsolatedSubflowsRemoval}
For every $n>0$, reduction\/ ${\to_{\frmis_n}}$ is sound; moreover, if\/ $\Phi\to_{\frmis_n}\Psi$, then the size of\/ $\Psi$ depends linearly on $N$, polynomially on the size of\/ $\Phi$ and at most polynomially on\/ $\max\{\size{\Gammasf_1},\dots,\size{\Gammasf_N}\}$.
\end{theorem}

\begin{proof}
Let $\Phi$ be a derivation with flow $\phi'$, such that $\phi'\to_{\frmis_n}\psi'$. We show that there exists a derivation $\Psi$ with flow $\psi'$ and with the same premiss and conclusion as $\Phi$. In the following, we refer to the figures in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}.

Since each of $\psi_1$, $\dots$, $\psi_n$ is connected, we assume, by Convention~\vref{convention:AlternativeAiDecomposedForm}, that the following derivation is an $\ai$-decomposed form of $\Phi$:
\[
\vlder{\Phi'}{}
{
 \vls[\beta\;.\;\vlinf{}{}{\fff}{\vls(a_1.\bar a_1^{\psi_1})}\;.\;\vlinf{}{}{\fff}{\vls(a_n.\bar a_n^{\psi_n})}]
}
{
 \vls(\vlinf{}{}{\vls[a_1.\bar a_1^{\psi_1}]}{\ttt}\;.\;\vlinf{}{}{\vls[a_n.\bar a_n^{\psi_n}]}{\ttt}\;.\;\alpha)
}\quad,
\]
for some atoms $a_1$, $\dots$, $a_n$ (that, without loss of generality, we assume coincide with the atoms given in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}) and formulae $\alpha$ and $\beta$.

For every $0\le k\le N$, we obtain the derivation $\Phi_k$ from $\Phi'$ as follows:
\[
\Phi_k\quad=\quad
\vlder{\Phi'\{\bar a_1^{\psi_1}/\gamma_{k,1},\dots,\bar a_n^{\psi_n}/\gamma_{k,n}\}}{}
{
 \vlsbr[\beta.(a_1.\gamma_{k,1}).\cdots.(a_n.\gamma_{k,n})]
}
{
 \vls([a_1.\gamma_{k,1}].\cdots.[a_n.\gamma_{k,n}].\alpha)
}
\]
Since each of $\psi_1$, $\dots$, $\psi_n$ is a connected component and contains no interaction or cut vertices, the mapping from occurrences of $\bar a_i^{\psi_i}$ to edges of $\psi_i$ is surjective. Hence, we know that $\Phi_k$ has flow
\[
\vcenter{\hbox{\includegraphics{Figures/thmMISR}}}
\quad.
\]
We combine $\Phi_0$, $\dots$, $\Phi_N$, $\Gammasf_1$, $\dots$, $\Gammasf_N$ to get the desired derivation $\Psi$ with flow $\psi'$ and the same premiss and conclusion as $\Phi$:
\[
\vlderivation
{
 \vlin{\cod}{}
 {
  \beta
 }
 {
  \vlin{\swi}{}
  {
   \vls
   [
    \vlinf{\cod}{}{\beta}{\vls[\beta.\beta]}
   \;\;\;.\;\;\;
    \vlder{\Phi_N}{}
    {
     \vlsbr[\beta\;.\;(\vlinf{}{}{\ttt}{a_1}\;.\;\fff)\;.\;\cdots\;.\;(\vlinf{}{}{\ttt}{a_n}\;.\;\fff)]
    }
    {
     \vls([a_1.\fff].\cdots.[a_n.\fff].\alpha)
    }
   ]
  }
  {
   \vlin{\swi}{}
   {
    \vls
    (
     [
      \vlinf{\cod}{}{\beta}{\vls[\beta.\beta]}
     \;\;\;\;.\;\;\;\;
      \vlder{\Phi_{N-1}}{}
      {
       \vlsbr
       [
        \beta
       \;\;.\;\;
        \vlder{\Gammasf_N}{}
        {
         \vlsmallbrackets\vls([a_1.\fff].\cdots.[a_n.\fff])
        }
        {
         \vlsmallbrackets\vls[(a_1.\gamma_{N-1,1}).\cdots.(a_n.\gamma_{N-1,n})]
        }
       ]
      }
      {
       \vlsmallbrackets\vls([a_1.\gamma_{N-1,1}].\cdots.[a_n.\gamma_{N-1,n}].\alpha)
      }
     ]
    \;\;\;\;.\;\;\;\;
     \alpha
    )
   }
   {
    \vlin{\swi}{}
    {
     \vdots
    }
    {
     \vlin{\swi}{}
     {
      \vls
      (
       [
        \beta
       \;\;\;\;.\;\;\;\;
        \vlder{\Phi_1}{}
        {
         \vlsbr
         [
          \beta
         \;\;.\;\;
          \vlder{\Gammasf_2}{}
          {
           \vlsmallbrackets\vls([a_1.\gamma_{2,1}].\cdots.[a_n.\gamma_{2,n}])
          }
          {
           \vlsmallbrackets\vls[(a_1.\gamma_{1,1}).\cdots.(a_n.\gamma_{1,n})]
          }
         ]
        }
        {
         \vlsmallbrackets\vls([a_1.\gamma_{1,1}].\cdots.[a_n.\gamma_{1,n}].\alpha)
        }
       ]
      \;\;\;\;.\;\;\;\;
       \vlinf{\cou}{}{\vls(\alpha.\alpha)}{\alpha}
      )
     }
     {
      \vlin{\cou}{}
      {
       \vls
       (
        \vlder{\Phi_0}{}
        {
         \vlsbr
         [
          \beta
         \;\;.\;\;
          \vlder{\Gammasf_1}{}
          {
           \vlsmallbrackets\vls([a_1.\gamma_{1,1}].\cdots.[a_n.\gamma_{1,n}])
          }
          {
           \vlsmallbrackets\vls[(a_1.\ttt).\cdots.(a_n.\ttt)]
          }
         ]
        }
        {
         \vlsbr([\vlinf{}{}{a_1}{\fff}\;.\;\ttt]\;.\;\cdots\;.\;[\vlinf{}{}{a_n}{\fff}\;.\;\ttt]\;.\;\alpha)
        }
       \;\;\;\;.\;\;\;\;
        \vlinf{\cou}{}{\vls(\alpha.\alpha)}{\alpha}
       )
      }
      {
       \vlhy{\alpha}
      }
     }
    }
   }
  }
 }
}
\qquad.
\]
Since $\max\{\size{\gamma_{0,1}},\dots,\size{\gamma_{N,n}}\}$ is less than or equal to $\max\{\size{\Gammasf_1},\dots,\size{\Gammasf_N}\}$, we know that the size of $\Phi_0$, $\dots$, $\Phi_N$ depend at most cubically on the size of $\Phi$ and at most quadratically on the size of $\max\{\size{\Gammasf_1},\dots,\size{\Gammasf_N}\}$ by Theorem~\vref{theorem:aiDecomposedForm} and Proposition~\vref{proposition:DerivationSubstitution}, and that the size of $\Psi$ depends at most cubically on the size of $\alpha$ and $\beta$ by Lemma~\vref{lemma:GenericContraction}, so the size of $\Psi$ depends linearly on $N$, polynomially on the size of $\Phi$ and at most polynomially on the size of $\max\{\size{\Gammasf_1},\dots,\size{\Gammasf_N}\}$.
\end{proof}
%----------

We now show the basic properties of $\to_\frmis$. Namely, that the reduction does not create any `new' interaction or cut vertices, and that it does not create any `new' paths between interaction or $\top$ and cut or $\bot$ vertices.

%-------------------------------------
\begin{lemma}\label{lemma:MultipleIsolatedSubflowsRemovalPaths}
In the following we refer to the names given in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}. Given two flows $\phi$ and $\psi$ and an $n>0$, such that $\phi\to_{\frmis_n}\psi$ then, given an interaction (resp., cut) vertex $\nu$ in $\psi$, there is an interaction (resp., cut) vertex $\nu'$ in $\phi$, such that
\begin{enumerate}
\item for some $1\le i\le N+1$, $\nu=f_i(\nu')$;
\item if there is a path from $\nu$ to $\bot$ (resp., $\top$), then there is a path from $\nu'$ to $\bot$ (resp., $\top$); and
\item if there is a cut (resp., interaction) vertex $\hat\nu$ in $\psi$, such that there is a path from $\nu$ to $\hat\nu$, then there is a cut (resp., interaction) vertex $\hat\nu'$ in $\phi$, such that, for some $1\le i\le N+1$, $\hat\nu=f_i(\hat\nu')$, or, for some $1\le i\le n$, $\hat\nu'=\nu_{\aiu,i}$ (resp., $\hat\nu'=\nu_{\aid,i}$); and there is a path from $\nu'$ to $\hat\nu'$.
\end{enumerate}
\end{lemma}

\begin{proof}
We consider each case separately:
\begin{enumerate}
 \item the statement follows by definition;
 \item any path from $\nu$ to $\bot$ (resp., $\top$) must contain an edge $\epsilon$, such that, for some lower (resp., upper) edge $\epsilon'$ of $\phi$ and some $1\le i\le N+1$, $f_i(\epsilon')=\epsilon$. Hence, there is a path from $\nu'$ to $\bot$ (resp., $\top$); and
 \item we have to consider two cases:
 \begin{enumerate}
  \item for some $1\le i\le N+1$, $\nu=f_i(\nu')$ and $\hat\nu=f_i(\hat\nu')$, then there is a path from $\nu'$ to $\hat\nu'$; or
  \item for some $1\le i<j\le N+1$, $\nu=f_i(\nu')$ and $\hat\nu=f_j(\hat\nu')$ (resp., $\nu=f_j(\nu')$ and $\hat\nu=f_i(\hat\nu')$), then, for some $1\le i\le n$, there is a path from $\nu'$ to $\nu_{\aiu,i}$ (resp., $\nu_{\aiu,i}$).
 \end{enumerate}
\end{enumerate}
\end{proof}
%----------

%--------------------------------
\begin{definition}\label{definition:MultipleIsolatedSubflowsRemover}
For every $n>0$, given the atoms, formulae and derivations described in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}, the \emph{Multiple Isolated Subflow Remover}\index{Multiple Isolated Subflows Remover!operator}, $\MISR_n$, is an operator whose arguments are atoms $a_1$, $\dots$, $a_n$ (that, without loss of generality, we assume coincide with the atoms given in Definition~\ref{definition:MultipleIsolatedSubflowsRemoval}), and a derivation $\Phi$ that is in simple form with respect to $a_1$, $\dots$, $a_n$. If $n=1$ and $\Phi$ is weakly streamlined with respect to $a_1$, then $\MISR_1(\Phi,a_1)=\Phi$; if $n>1$ and, for some $1\le i\le n$, $\Phi$ is weakly streamlined with respect to $a_i$, then $\MISR_n(\Phi,a_1,\dots,a_n)=\MISR_{n-1}(\Phi,a_1,\dots,a_{i-1},a_{i+1},\dots,a_n)$; otherwise, consider the following $\ai$-decomposed form of $\Phi$:
\[
\vlder{\Phi'}{}
{
 \vlsbr
 [
  \beta
 \;.\;
  \vlinf{}{}
  {
   \fff
  }
  {
   \vls(a_n^{\psi_n}.\bar a_n)
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \fff
  }
  {
   \vls(a_n^{\psi_n}.\bar a_n)
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \fff
  }
  {
   \vls(a_1^{\psi_1}.\bar a_1)
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \fff
  }
  {
   \vls(a_1^{\psi_1}.\bar a_1)
  }
 ]
}
{
 \vlsbr
 (
  \vlinf{}{}
  {
   \vls[a_1^{\psi_1}.\bar a_1]
  }
  {
   \ttt
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \vls[a_1^{\psi_1}.\bar a_1]
  }
  {
   \ttt
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \vls[a_n^{\psi_n}.\bar a_n]
  }
  {
   \ttt
  }
 \;.\;\cdots\;.\;
  \vlinf{}{}
  {
   \vls[a_n^{\psi_n}.\bar a_n]
  }
  {
   \ttt
  }
 \;.\;
  \alpha
 )
}\quad,
\]
with flow
\[
\vcenter{\hbox{\includegraphics{Figures/defMISR1}}}
\quad,
\]
where, for $1\le i\le n$, $\psi_i$ is the juxtaposition of all the isolated subflows mapped to from occurrences of $a_i$ in $\Phi$. Consider the derivation
\[
\Psi\;=\;
\vlder{\Phi'}{}
{
 \vlsbr
 [
  \beta
 \;\;\;.\;\;\;
  \vlderivation
  {
   \vlin{}{}
   {
    \fff
   }
   {
    \vlde{}{\{\cod\}}
    {
     \vls(a_n.\bar a_n)
    }
    {
     \vlhy
     {
      \vls[(a_n.\bar a_n).\cdots.(a_n.\bar a_n)]
     }
    }
   }
  }
 \;\;\;.\;\;\;\cdots\;\;\;.\;\;\;
  \vlderivation
  {
   \vlin{}{}
   {
    \fff
   }
   {
    \vlde{}{\{\cod\}}
    {
     \vls(a_1.\bar a_1)
    }
    {
     \vlhy
     {
      \vls[(a_1.\bar a_1).\cdots.(a_1.\bar a_1)]
     }
    }
   }
  }
 ]
}
{
 \vlsbr
 (
  \vlderivation
  {
   \vlde{}{\{\cou\}}
   {
    \vls([a_1.\bar a_1].\cdots.[a_1.\bar a_1])
   }
   {
    \vlin{}{}
    {
     \vls[a_1.\bar a_1]
    }
    {
     \vlhy
     {
      \ttt
     }
    }
   }
  }
 \;\;\;.\;\;\;\cdots\;\;\;.\;\;\;
  \vlderivation
  {
   \vlde{}{\{\cou\}}
   {
    \vls([a_n.\bar a_n].\cdots.[a_n.\bar a_n])
   }
   {
    \vlin{}{}
    {
     \vls[a_n.\bar a_n]
    }
    {
     \vlhy
     {
      \ttt
     }
    }
   }
  }
 \;\;\;.\;\;\;
  \alpha
 )
}\quad,
\]
with flow
\[
\psi''\;=\;
\vcenter{\hbox{\includegraphics{Figures/defMISR2}}}
\quad.
\]
We then define $\MISR_n(\Phi,a_1,\dots,a_n)$ to be such that $\Psi\to_\frmis\MISR_n(\Phi,a_1,\dots,a_n)$, where $\phi$, $\psi_1$, $\dots$, $\psi_n$ are the flows, by the same names, shown in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}.
\end{definition}
%---------------

%--------------------------------------------------------------------
\begin{proposition}\label{proposition:MultipleIsolatedSubflowRemover}
Given the atoms, formulae and derivations described in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}, and atoms $a_1$, $\dots$, $a_n$ and a derivation $\Phi$ that is in simple form with respect to $a_1$, $\dots$, $a_n$,
\begin{enumerate}
\item $\MISR_n(\Phi,a_1,\dots,a_n)$ is weakly streamlined with respect to $a_1$, $\dots$, $a_n$;
\item for any atom $b$,
\begin{enumerate}
\item if $\Phi$ is weakly streamlined with respect to $b$, then $\MISR_n(\Phi,a_1,\dots,a_n)$ is weakly streamlined with respect to $b$, and
\item if $b$ is not the dual of any of $a_1$, $\dots$, $a_n$ and $\Phi$ is in simple form with respect to $b$, then $\MISR_n(\Phi,a_1,\dots,a_n)$ is in simple form with respect to $b$; and
\end{enumerate}
\item the size of\/ $\MISR_n(\Phi,a_1,\dots,a_n)$ depends linearly on $N$, polynomially on the size of\/ $\Phi$, and at most polynomially on $\max\{\size{\Gammasf_1},\dots,\size{\Gammasf_N}\}$.
\end{enumerate}
\end{proposition}

\begin{proof}
If $\Phi$ is weakly streamlined with respect to some atom from $a_1$, $\dots$, $a_n$, the result follows by induction. Assume $\Phi$ is not weakly streamlined with respect to any atom from $a_1$, $\dots$, $a_n$, and let $\phi$, $\psi_1$, $\dots$, $\psi_n$, $\phi'$, $\psi'_1$, $\dots$, $\psi'_n$ and $\psi''$ be the flows given in Definition~\vref{definition:MultipleIsolatedSubflowsRemover}, then
\begin{enumerate}
\item by definition there is no path in $\phi$ from an interaction to a cut vertex whose edges are mapped to from instances of one of $a_1$, $\dots$, $a_n$. By Lemma~\vref{lemma:MultipleIsolatedSubflowsRemovalPaths}, we know that if there is a path from an interaction to a cut vertex in the flow of $\MISR_n(\Phi,a_1,\dots,a_n)$ whose edges are mapped to from instances of one of $a_1$, $\dots$, $a_n$, then there must be a path from an interaction to a cut vertex in $\phi$ whose edges are mapped to from instances of one of $a_1$, $\dots$, $a_n$. Hence, the statement follows by contradiction;
\item
\begin{enumerate}
 \item if the flow of $\MISR_n(\Phi,a_1,\dots,a_n)$ contains a path from an interaction vertex to a cut vertex whose edges are mapped to from $b$, then, by Lemma~\ref{lemma:MultipleIsolatedSubflowsRemovalPaths}, there is a path from an interaction vertex to a cut vertex in $\phi$, so also in $\phi'$, whose edges are mapped to from $b$. Hence, the statement follows by contradiction; and
 \item if there is an interaction (reps., cut) vertex $\nu$ and a cut (resp., interaction) vertex $\hat\nu$ in the flow of $\MISR_n(\Phi,a_1,\dots,a_n)$ such that there is a path from $\nu$ to $\hat\nu$ and a path from $\nu$ to $\bot$ (resp., $\top$), both of whose edges are mapped to from $b$, then, by Lemma~\ref{lemma:MultipleIsolatedSubflowsRemovalPaths}, there is an interaction (resp., cut) vertex $\nu'$ and a cut (resp., interaction) vertex $\hat\nu'$ in $\phi$ such that there is a path from $\nu$ to $\hat\nu$ and a path from $\nu$ to $\bot$ (resp., $\top$), both of whose edges are mapped to from $b$. Furthermore, since we can assume that $b$ is not any of $a_1$, $\dots$, $a_n$ or their duals, $\phi$ restricted to $b$ equals $\phi'$ restricted to $b$. Hence, the statement follows by contradiction.
\end{enumerate}
\item the statement follows by Theorem~\vref{theorem:SoundMultipleIsolatedSubflowsRemoval}.
\end{enumerate}
\end{proof}
%----------

%--------------------------------------------------
\begin{remark}\label{remark:FromGammasToThresholds}
Given the atoms, formulae and derivations described in Definition~\vref{definition:MultipleIsolatedSubflowsRemoval}, we can prove by induction on $k$, that, for every $1\le i\le n$ and every $0\le k\le N$, the formula $\gamma_{k,i}$ is
\begin{itemize}
 \item true if at least $k$ of the atoms $a_1$, $\dots$, $a_{i-1}$, $a_{i+1}$, $\dots$, $a_n$ are true; and
 \item false if at least $N-k$ of the atoms $a_1$, $\dots$, $a_{i-1}$, $a_{i+1}$, $\dots$, $a_n$ are false.
\end{itemize}
It follows by contradiction that $N\ge n$. Furthermore, if $N=n$, we know that $\gamma_{k,i}$ is true if and only if at least $k$ of the atoms $a_1$, $\dots$, $a_{i-1}$, $a_{i+1}$, $\dots$, $a_n$ are true. This makes $\gamma_{k,i}$ a \emph{threshold formula}\index{threshold formula}, as we will see in the next section.
\end{remark}
%-----------

%=============================
\input{global_reductions/threshold_formulae.tex}