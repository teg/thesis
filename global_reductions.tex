\section{Global Reductions}\label{section:GlobalReductions}


In this and the next chapter we see the second use of atomic flows: Controlling normalisation of derivations. Conventional wisdom teaches us that normalisation is a delicate property, and that a careful design of inference rules is necessary in order to obtain it. Atomic flows were designed to describe normal forms, by removing a lot of information about the inference rules, it is therefore surprising that they contain enough information to design normalisation procedures.

There are two kinds of flow reductions: global and local ones. In global reductions, the entire flow is rewritten: normally, two or more slightly altered copies of a flow are connected together. In local reductions, a bounded subflow in a flow is substituted by another subflow that fits in the context.

This chapter is dedicated to the most challenging part of normalisation: obtaining weakly streamlined derivations through global reductions. The process is non-confluent, and at first glance it increases the size of derivations exponentially. However, a second surprise was the fact that we are able to design procedures for weakly streamlining which only grow derivations quasipolynomially.

We will define several `atomic flow reductions' which can be combined in different ways in order to obtain normalisation. Since we aim to produce derivations on normal forms, and not only their atomic flows, we find it convenient to define \emph{operators} on derivations in terms of the flow reductions. It is important to note that we could have performed all the procedures purely in terms of atomic flows. The final results about derivations would follow from the `soundness' of the flow reductions. We chose to be a bit more explicit and provide the derivations directly.

%-------------------------------------------------
\begin{definition}\label{definition:FlowReduction}
An (\emph{atomic-flow}) \emph{reduction $R$}\index{reduction} is a binary relation on the set of atomic flows, such that $\phi\mathrel{R}\psi$ if
\begin{enumerate}
\item
there is a one-to-one map, $f$, from the upper edges of $\phi$ to the upper edges of $\psi$;
\item
there is a one-to-one map, $g$, from the lower edges of $\phi$ to the lower edges of $\psi$; and
\item\label{definition:FlowReduction:item:Polarity}
for every polarity assignment $\pi$ for $\phi$, there is a polarity assignment $\pi'$ for $\psi$ such that $\pi'(f(\epsilon))=\pi(\epsilon)$ and $\pi'(g(\iota))=\pi(\iota)$, for any upper edge $\epsilon$ and any lower edge $\iota$ of $\phi'$.
\end{enumerate}
We call $\phi$ a \emph{redex} and $\psi$ a \emph{contractum} of $\mathrel R$.
\end{definition}
%---------------

%-----------------------------------------------
\begin{remark}\label{remark:LabelBijectionEdges}
Given a reduction $R$ and two atomic flows $\phi$ and $\psi$, such that $\phi\mathrel{R}\psi$, we indicate the bijections $f$ and $g$ by labeling the upper (resp., lower) edge $f(\epsilon)$ (resp., $g(\epsilon)$) of $\psi$ by $\epsilon$, for every upper (resp., lower) edge $\epsilon$ of $\phi$.
\end{remark}
%-----------

%--------------------------------------------------
\begin{definition}\label{definition:SoundRedcution}
A reduction $\mathrel{R}$ is \emph{sound}\index{reduction!sound} if, for every $\phi$ and $\psi$, such that $\phi\mathrel{R}\psi$, and for every derivation $\Phi$ with atomic flow $\phi$, there is a derivation $\Psi$ with atomic flow $\psi$ such that $\Phi$ and $\Psi$ have the same premiss and conclusion; in this case we write $\Phi\mathrel{R}\Psi$.
\end{definition}
%---------------

%-----------------
\begin{convention}
We provide constructive soundness proofs for every reduction in this thesis, so from now on, for any reduction $\mathrel{R}$, when we write $\Phi\mathrel{R}\Psi$, we mean that $\Psi$ is the derivation obtained form $\Phi$ in the soundness proof of $\mathrel{R}$.
\end{convention}
%---------------

%------------------------------------------------------------
\begin{proposition}\label{proposition:DerivationSubstitution}
Given a derivation\/ $\vlder\Phi\SKS{\beta}\alpha$, let its associated flow have shape
\[
\atomicflow{
(-5, 6)*{\afvjdm4{}{}};
( 5, 6)*{\afvjdm4{}{}};
(-1, 2)*{\aflabelleft\phi};
( 9, 2)*{\aflabelleft\psi};
(-5, 0)*{\affr88};
( 5, 0)*{\affr88};
(-5,-6)*{\afvjum4{}{}};
( 5,-6)*{\afvjum4{}{}}
}
\quad,
\]
such that $\phi$ is a connected component whose edges are each associated with atom $a$; then, for any formula $\gamma$, there exists a derivation
\[
\vlder\Psi\SKS{\beta \{a^\phi/\gamma\}}
              {\alpha\{a^\phi/\gamma\}}
\]
whose associated flow is
\[
\atomicflow{
(-17, 6)*{\afvjdm4{}{}};
( -5, 6)*{\afvjdm4{}{}};
(  5, 6)*{\afvjdm4{}{}};
(-13, 2)*{\aflabelleft{f_1(\phi)}};
( -1, 2)*{\aflabelleft{f_n(\phi)}};
(  9, 2)*{\aflabelleft\psi};
(-17, 0)*{\affr88};
(-11, 0)*{\cdots};
( -5, 0)*{\affr88};
(  5, 0)*{\affr88};
(-17,-6)*{\afvjum4{}{}};
( -5,-6)*{\afvjum4{}{}};
(  5,-6)*{\afvjum4{}{}};
}
\quad,
\]
where $n$ is the number of atom occurrences in $\gamma$; moreover, the size of\/ $\Psi$ depends linearly on the size of\/ $\Phi$ and quadratically on the size of $\gamma$.
\end{proposition}
%----------------

%-------------------------------------------------------------------------------
\begin{proof}
We can proceed by structural induction on $\Phi$. For every formula in $\Phi$ we substitute $a^\phi$ with $\gamma$. Since all the edges in $\phi$ are mapped to from $a$ (and not $\bar a$), we know that all the vertices in $\phi$ are mapped to from instances of $\acd$, $\acu$, $\awd$ and $\awu$. We substitute every instance of $\acd$, $\acu$, $\awd$ and $\awu$ where $a^\phi$ appears, by $\cod$, $\cou$, $\wed$, $\weu$, respectively, with $\gamma$ in the place of $a^\phi$. The result then follows by Proposition~\vref{proposition:GenericStructural}.
\end{proof}
%----------

%---------------
\begin{notation}
The derivation $\Psi$ obtained in the proof of Propostion~\vref{proposition:DerivationSubstitution} is denoted $\Phi\{a^\phi/\gamma\}$.
\end{notation}
%-------------

%-------------
\begin{remark}
The notion of substitution can be extended to allow $\phi$ to contain interaction and cut vertices, but we shall not need that in this thesis.
\end{remark}
%-----------

%-----------------
\begin{convention}
To avoid ambiguity in Definition~\vref {definition:FourBoxes}, Definition~\vref {definition:IsolatedSubflowRemoval} and Definition~\vref {definition:PathBreaker} we have establish the following convention:
Let $\boldsymbol\epsilon=\epsilon_1,\dots,\epsilon_n$, $\boldsymbol\iota=\iota_1,\dots,\iota_m$, $\boldsymbol{\epsilon'}=\epsilon'_1,\dots,\epsilon'_n$ and $\boldsymbol{\iota'}=\iota'_1,\dots,\iota'_m$, then, when we write
\[
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0, 6)*{\afvjdm4{\boldsymbol\epsilon}{}};
(  0, 0)*{\affr{14}8};
(  0, 0)*{\copy\contrup};
( -6,-6)*{\afvjdm4{f_1(\boldsymbol\epsilon)}{}};
(  0,-6)*{\cdots};
(  6,-6)*{\afvjdm4{}{f_k(\boldsymbol\epsilon)}};
( 10, 0)*{\invisiblemark};
}
\qquad\mbox{and}\qquad
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0,-6)*{\afvjum4{\boldsymbol\iota}{}};
(  0, 0)*{\affr{14}8};
(  0, 0)*{\copy\contrdown};
( -6, 6)*{\afvjum4{f_1(\boldsymbol\iota)}{}};
(  0, 6)*{\cdots};
(  6, 6)*{\afvjum4{}{f_k(\boldsymbol\iota)}};
( 10, 0)*{\invisiblemark};
}
\]
we mean
\[
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0,6)*{\afvjd4{\epsilon_1}{}};
(  0,0)*{\affr{14}8};
(  0,0)*{\copy\contrup};
( -6,-6)*{\afvjd4{f_1(\epsilon_1)}{}};
(  0,-6)*{\cdots};
(  6,-6)*{\afvjd4{}{f_k(\epsilon_1)}};
( 10, 0)*{\invisiblemark};
}
\quad\cdots\quad
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0,6)*{\afvjd4{\epsilon_n}{}};
(  0,0)*{\affr{14}8};
(  0,0)*{\copy\contrup};
( -6,-6)*{\afvjd4{f_1(\epsilon_n)}{}};
(  0,-6)*{\cdots};
(  6,-6)*{\afvjd4{}{f_k(\epsilon_n)}};
( 10, 0)*{\invisiblemark};
}
\qquad\mbox{and}\qquad
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0,-6)*{\afvjd4{\iota_1}{}};
(  0, 0)*{\affr{14}8};
(  0, 0)*{\copy\contrdown};
( -6, 6)*{\afvjd4{f_1(\iota_1)}{}};
(  0, 6)*{\cdots};
(  6, 6)*{\afvjd4{}{f_k(\iota_1)}};
( 10, 0)*{\invisiblemark};
}
\quad\cdots\quad
\atomicflow
{
(-10, 0)*{\invisiblemark};
(  0,-6)*{\afvjd4{\iota_m}{}};
(  0, 0)*{\affr{14}8};
(  0, 0)*{\copy\contrdown};
( -6, 6)*{\afvjd4{f_1(\iota_m)}{}};
(  0, 6)*{\cdots};
(  6, 6)*{\afvjd4{}{f_k(\iota_m)}};
( 10, 0)*{\invisiblemark};
}
\quad,
\]
respectively. In other words, edges are not connected in unexpected ways.
\end{convention}
%-----------

%======================================
\subsection{Simplifier}\label{subsection:Simplifier}

\input{global_reductions/simplifier.tex}

%======================================
\subsection{Isolated Subflow Removal}\label{subsection:IsolatedSubflowRemoval}

\input{global_reductions/isolated_subflow.tex}

%======================================
\subsection{Path Breaker}\label{subsection:PathBreaker}

\input{global_reductions/path_breaker.tex}