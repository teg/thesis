
%====================
\section{Atomic Flows}

\TODO{Decide what to keep and what to cut from this section.}

In this chapter we introduce the main contribution of this thesis, a geometric, bureaucracy-free formalism, called `atomic flows'. An atomic flow is a directed graph obtained from a derivation by only retaining information about the creation and destruction of atom occurrences. Atomic flows are, essentially, specialised Buss flow graphs \cite{Buss:91:The-Unde:uq,Carb:97:Interpol:fk}. Notably, the atomic flow of a derivation completely disregards all the logical relations and associated inference rule instances; so, an atomic flow is not a derivation, but only a very abstract representation of it.

Atomic flows have much in common with proof nets \cite{Stra:05:From-Dee:yb}. However, we prove that, no matter how we freely build an atomic flow (as opposed to a proof net structure), the flow is associated with some derivation. So, atomic flows are always `sequentialisable', in proof-net parlance. In fact, atomic flows carry much less information than derivations do, because they do not keep track of the logical relations between the atoms they trace, only their structural information is retained (in the sense of structural rules, as opposed to logical ones).

We can think of atomic flows as composite diagrams that are freely generated from a set of six elementary diagrams. Technically, atomic flows are special kinds of labelled directed acyclic graphs, and the properties of their vertices are dictated by their labels, which we define as follows.

%----------------------------------------------
\begin{definition}\label{definition:FlowLabels}
We call the following six diagrams (\emph{atomic-flow}) \emph{labels}\index{flow!labels}:
\[
\begin{array}{@{}c@{}c@{}c@{}}
      \vcenter{\afaid{}{}{}{}{}{}}&
\qquad\vcenter{\afawd{}{}{}{}}&
\qquad\vcenter{\afacd{}{}{}{}{}{}}\\
\noalign{\smallskip}
      \mbox{$\aid$ or \emph{interaction}}&
\qquad\mbox{$\awd$ or \emph{weakening}}&
\qquad\mbox{$\acd$ or \emph{contraction}}\\
\noalign{\bigskip}
      \vcenter{\afaiu{}{}{}{}{}{}}&
\qquad\vcenter{\afawu{}{}{}{}}&
\qquad\vcenter{\afacu{}{}{}{}{}{}}\\
\noalign{\smallskip}
      \mbox{$\aiu$ or \emph{cut}}&
\qquad\mbox{$\awu$ or \emph{coweakening}}&
\qquad\mbox{$\acu$ or \emph{cocontraction}}\\
\end{array}\quad.
\]
\end{definition}
%---------------


\newcommand{\one  }{{\mathchoice{\scriptstyle\mathbf1}
                                {\scriptstyle\mathbf1}
                                {\scriptstyle\mathbf1}
                                {\scriptscriptstyle\mathbf1}}}
\newcommand{\two  }{{\mathchoice{\scriptstyle\mathbf2}
                                {\scriptstyle\mathbf2}
                                {\scriptstyle\mathbf2}
                                {\scriptscriptstyle\mathbf2}}}
\newcommand{\three}{{\mathchoice{\scriptstyle\mathbf3}
                                {\scriptstyle\mathbf3}
                                {\scriptstyle\mathbf3}
                                {\scriptscriptstyle\mathbf3}}}
\newcommand{\four }{{\mathchoice{\scriptstyle\mathbf4}
                                {\scriptstyle\mathbf4}
                                {\scriptstyle\mathbf4}
                                {\scriptscriptstyle\mathbf4}}}
\newcommand{\five }{{\mathchoice{\scriptstyle\mathbf5}
                                {\scriptstyle\mathbf5}
                                {\scriptstyle\mathbf5}
                                {\scriptscriptstyle\mathbf5}}}
\newcommand{\six  }{{\mathchoice{\scriptstyle\mathbf6}
                                {\scriptstyle\mathbf6}
                                {\scriptstyle\mathbf6}
                                {\scriptscriptstyle\mathbf6}}}
\newcommand{\seven}{{\mathchoice{\scriptstyle\mathbf7}
                                {\scriptstyle\mathbf7}
                                {\scriptstyle\mathbf7}
                                {\scriptscriptstyle\mathbf7}}}
\newcommand{\eight}{{\mathchoice{\scriptstyle\mathbf8}
                                {\scriptstyle\mathbf8}
                                {\scriptstyle\mathbf8}
                                {\scriptscriptstyle\mathbf8}}}
\newcommand{\nine }{{\mathchoice{\scriptstyle\mathbf9}
                                {\scriptstyle\mathbf9}
                                {\scriptstyle\mathbf9}
                                {\scriptscriptstyle\mathbf9}}}
\newcommand{\ppl  }{{\mathchoice{\scriptstyle+}
                                {\scriptstyle+}
                                {\scriptstyle+}
                                {\scriptscriptstyle+}}}
\newcommand{\pmi  }{{\mathchoice{\scriptstyle-}
                                {\scriptstyle-}
                                {\scriptstyle-}
                                {\scriptscriptstyle-}}}
\newcommand{\card}[1]{\mathord\vert #1\mathord\vert}
\newcommand{\up}{{\mathit up}}
\newcommand{\lo}{{\mathit lo}}
%---------------------------------------
\begin{definition}\label{definition:AtomicFlow}
An (\emph{atomic}) \emph{flow}\index{flow}\index{atomic flow|see{flow}} is a tuple $(V,E,\eta,\up,\lo)$, denoted $\phi$ or $\psi$, such that:
\begin{enumerate}
%-------------------
\item $V$ is a finite set of \emph{vertices}\index{flow!vertices}, denoted by $\nu$;
%-------------------
\item $E$ is a finite set of \emph{edges}\index{flow!edges}, denoted by $\epsilon$, $\iota$ or small numerals $\one$, $\two$, $\dots$;
%-------------------
\item $\eta\colon V\to\{\aid,\aiu,\awd,\awu,\acd,\acu\}$ maps vertices to their \emph{labels}\index{flow!labels};
%-------------------
\item $\up\colon E\to V\cup\{\top\}$ and $\lo\colon E\to V\cup\{\bot\}$ are, respectively, the \emph{upper} and \emph{lower} maps, and $\top$ and $\bot$ are special vertices not belonging to $V$; we define, for every $\nu\in V\cup\{\top,\bot\}$, the set $L_\nu=\{\,\epsilon\mid\up(\epsilon)=\nu\,\}$ of \emph{lower edges of $\nu$}, the set $U_\nu=\{\,\epsilon\mid\lo(\epsilon)=\nu\,\}$ of \emph{upper edges of $\nu$}, and the set $E_\nu=L_\nu\cup U_\nu$ of \emph{edges of $\nu$};
%-------------------
\item if $\card S$ denotes the cardinality of set $S$, we have that
\begin{align*}
\mbox{if $\eta(\nu)=\aid$ then $\card{L_\nu}=2$ and $\card{U_\nu}=0$,}&\\
\mbox{if $\eta(\nu)=\aiu$ then $\card{L_\nu}=0$ and $\card{U_\nu}=2$,}&\\
\mbox{if $\eta(\nu)=\awd$ then $\card{L_\nu}=1$ and $\card{U_\nu}=0$,}&\\
\mbox{if $\eta(\nu)=\awu$ then $\card{L_\nu}=0$ and $\card{U_\nu}=1$,}&\\
\mbox{if $\eta(\nu)=\acd$ then $\card{L_\nu}=1$ and $\card{U_\nu}=2$,}&\\
\mbox{if $\eta(\nu)=\acu$ then $\card{L_\nu}=2$ and $\card{U_\nu}=1$;}&
\end{align*}
%-------------------
\item\label{definition:AtomicFlow:item:Acyclic} there is no sequence $\epsilon_1$, $\dots$, $\epsilon_h$ of edges of $V$ such that $\up(\epsilon_i)=\lo(\epsilon_{i+1\pmod h})$, for $1\le i\le h$;
%-------------------
\item\label{definition:AtomicFlow:item:PolarityAssignment} there is a \emph{polarity assignment}\index{flow!polarity assignment} $\pi\colon E\to\{\pmi,\ppl\}$ such that, for every $\nu\in V$,
\begin{enumerate}
%---------
\item if $\eta(\nu)\in\{\acd,\acu\}$ then $\pi(E_\nu)=\{\pmi\}$ or $\pi(E_\nu)=\{\ppl\}$;
%---------
\item if $\eta(\nu)\in\{\aid,\aiu\}$ then $\pi(E_\nu)=\{\pmi,\ppl\}$.
\end{enumerate}
\end{enumerate}
Given an atomic flow $\phi$, we say that the sets $L_\top=\{\epsilon_1,\dots,\epsilon_h\}$ and $U_\bot=\{\iota_1,\dots,\iota_k\}$ contain, respectively, the \emph{upper}\index{flow!upper edges} and \emph{lower edges of $\phi$}\index{flow!lower edges}.
\end{definition}
%---------------

An atomic flow is a directed graph, whose edges are associated to atom occurrences in derivations, and the direction of the edges corresponds to the up-down direction in a derivation. Vertices are associated to points in the derivation where atom occurrences are created or destroyed, and the nature of each vertex is described by its label. Naturally, these graphs are acyclic (condition~\ref{definition:AtomicFlow:item:Acyclic}). The two special vertices $\top$ and $\bot$ represent the top and bottom of a derivation: we can consider $\top$ the vertex that creates all the atom occurrences in the premiss and $\bot$ the vertex that destroys all atom occurrences in the conclusion.

The polarity assignment condition (\ref{definition:AtomicFlow:item:PolarityAssignment}) ensures that atoms in (co)contractions have the same polarity, and those in interactions and cuts have dual polarities (as happens in derivations). Every atomic flow has $2^n$ polarity assignments, where $n$ is the number of connected components in the graph. We should not be worried about the apparent complexity of the polarity assignment condition: in fact, we could equivalently consider two sorts of (co)contraction and (co)weakening labels, the negative and the positive ones, and ask for vertices to be joined by respecting their polarities. This is clearly a locally checkable property, much simpler than, for example, some global correctness criterion for proof nets.

\newbox\contrup\setbox\contrup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afacu{}{}{}{}{}{}}}$}
\newbox\contrdown\setbox\contrdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afacd{}{}{}{}{}{}}}$}
\newbox\interdown\setbox\interdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afaid{}{}{}{}{}{}}}$}
\newbox\interup\setbox\interup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afaiu{}{}{}{}{}{}}}$}
\newbox\weakdown\setbox\weakdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afawd{}{}{}{}{}{}}}$}
\newbox\weakup\setbox\weakup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afawu{}{}{}{}{}{}}}$}

\begin{notation}\label{notation:LabelsOnBoxes}
Let $\phi$ be an atomic flow with upper edges $\boldsymbol\epsilon=\epsilon_1,\dots,\epsilon_n$ and lower edges $\boldsymbol\iota=\iota_1,\dots,\iota_m$, we then represent it as
\[
\atomicflow{
(-3, 6)*{\afvju4{\epsilon_1}{}};
( 0, 6)*{\cdots};
( 3, 6)*{\afvju4{}{\epsilon_n}};
( 0, 0)*{\affr88};
( 1, 2)*{\aflabelright\phi};
(-3,-6)*{\afvju4{\iota_1}{}};
( 0,-6)*{\cdots};
( 3,-6)*{\afvju4{}{\iota_m}};
}
\qquad\mbox{or}\qquad
\atomicflow{
( 0,6)*{\afvjum4{\boldsymbol\epsilon}{}};
( 0,0)*{\affr88};
( 1,2)*{\aflabelright\phi};
( 0,-6)*{\afvjdm4{\boldsymbol\iota}{}};
}\quad.
\]
We sometimes use flow labels to indicate what kind of vertices an atomic flow might contain. \emph{E.g.}, the following flows
\[
\atomicflow{
( 0, 6)*{\afvjm4};
(-2, 0)*{\copy\contrup};
( 0, 0)*{\affr{10}8};
( 2, 0)*{\copy\contrdown};
( 0,-6)*{\afvjm4};
}\qquad\mbox{and}\qquad
\atomicflow{
(0, 6)*{\afvjm4};
(0, 0)*{\affr88};
(0, 0)*{\copy\contrdown};
(0,-6)*{\afvjm4};
}\quad,
\]
do not contain $\aid$, $\aiu$, $\awd$, $\awu$ vertices, and the flow to the right does not contain $\acu$ vertices.

In general, we represent atomic flows as directed-graph diagrams, except that the special vertices $\top$ and $\bot$ are not shown, and the labels of the vertices are explicitly shown as graphical elements. When we refer to the vertices of an atomic flow, we do not include $\top$ and $\bot$. Sometimes we identify vertices with their labels. 
\end{notation}
%-------------

%--------------
\begin{example}
Consider the atomic flow
\begin{align*}
A=(&\{\;\nu_1\;,\;\nu_2\;,\;\nu_3\;\},\\
   &\{\;\one\;,\;\two\;,\;\three\;,\;\four\;,\;\five\;\},\\
   &\{\;\nu_1\mapsto\aiu\;,\;\nu_2\mapsto\acu\;,\;\nu_3\mapsto\aiu\;\},\\
   &\{\;\one\mapsto\top\;,\;\two\mapsto\top\;,\;\three\mapsto\nu_2\;,\;
        \four\mapsto\nu_2\;,\;\five\mapsto\top\;\},\\
   &\{\;\one\mapsto\nu_1\;,\;\two\mapsto\nu_2\;,\;\three\mapsto\nu_1\;,\;
        \four\mapsto\nu_3\;,\;\five\mapsto\nu_3\;\})
\quad;
\end{align*}
the following are three of its possible representations:
\[
\atomicflow{
(10,8)*{\afacu\four{}{}{}{}\two};
( 0,8)*{\afvjd8\one{}};
( 4,8)*{\afvjd8{}\five};
( 6,2)*{\afaiunw{}{}};
( 6,0)*{\afaiuex{}{}{}\three{}{}31}}
\quad,\qquad
\aflower{\atomicflow{
( 0  ,6)*{\afvjd{8}\one\ppl};
( 6  ,6)*{\afacu\three{}{}\four\two\pmi};
(12  ,6)*{\afvjd{8}\ppl\five};
(10  ,0)*{\afaiunw{}{}};
( 2  ,0)*{\afaiunw{}{}};
(-1.5,0)*{\invisiblemark};
(13.5,0)*{\invisiblemark}}}
\qquad\hbox{and}\qquad
\atomicflow{
( 8  ,10)*{\afacu{}\three{}\four\two\ppl};
( 0  , 8)*{\afvjd{12}\one\pmi};
( 4  ,10)*{\afvjd{8}\five\pmi};
( 5  , 4)*{\afex24};
(10  , 4)*{\afvj4};
( 2  , 0)*{\afaiunw{}{}};
( 8  , 0)*{\afaiunw{}{}};
(-1.5, 0)*{\invisiblemark};
(11.5, 0)*{\invisiblemark}}
\quad;
\]
in the last two diagrams, we also indicated each of the two possible polarity assignments. This flow has one cocontraction and two cointeraction vertices; it has three upper edges, $\one$, $\two$ and $\five$, and no lower edges.
\end{example}
%------------

\begin{example}
The flow
\[
\atomicflow{
(17,12)*{\afaid{}{}{}{}{}{}};
(-3, 8)*{\afvjd8{}{}};
(-1, 8)*{\afvjd8{}{}};
( 1, 8)*{\afvjd8{}{}};
( 4, 8)*{\afvjd8{}{}};
(10, 8)*{\afacu{}{}{}{}{}{}};
(17, 4)*{\afaiu{}{}{}{}{}{}};
( 6, 2)*{\afaiunw{}{}}}
\]
is obtained by juxtaposing (\emph{i.e.}, composing by identifying zero edges):
\begin{itemize}
\item three edges, 
\item a flow obtained by composing a cut vertex with a cocontraction vertex, and
\item a flow obtained by composing an identity vertex with a cut vertex.
\end{itemize}
Note that there are no cycles in the flow, and that we can find 32 different polarity assignments, \emph{i.e.}, two for each of the five connected components of the flow.
\end{example}

%--------------
\begin{example}
The following two diagrams are not atomic flows:
\[
\atomicflow{
(4,11.7)*{\afacu{}{}{}{}{}{}};
(0, 3.7)*{\afacd{}{}{}{}{}{}};
(8, 7.7)*{\afvj{16}};
(4,16);(8,16)**[|<\atflowthickone>]\crv{(4,18)&(6,20)&(8,18)};
(0,0);(8,0)**[|<\atflowthickone>]\crv{(0,-2)&(4,-4)&(8,-2)}
}
\qquad\mbox{and}\qquad
\atomicflow{
(0,4)*{\afaidnw{}{}};
(0,0)*{\afacd{}{}{}{}{}{}}
}\quad.
\]
The left one is not a flow because there is a cycle in it, and the right one because there is no possible polarity assignment.
\end{example}
%------------

%---------------------------------------------------
\begin{definition}\label{definition:FlowIsomorphism}
An (\emph{atomic}) \emph{flow isomorphism}\index{flow!isomorphism} between the atomic flows $\phi_1=(V_1,E_1,\eta_1,\up_1,\lo_1)$ and $\phi_2=(V_2,E_2,\eta_2,\up_2,\lo_2)$ is a pair of functions $(f_V,f_E)$, such that
\begin{itemize}
\item $f_V$ is a bijection from $V_1$ to $V_2$; and 
\item $f_E$ is a bijection from $E_1$ to $E_2$,
\end{itemize}
such that, for every $\epsilon$ in $E_1$,
\begin{itemize}
\item for every $\nu$ in $V_1$, $\up_1(\epsilon)=\nu$ (resp., $\lo_1(\epsilon)=\nu$) if and only if $\up_2(f_E(\epsilon))=f_V(\nu)$ (resp., $\lo_2(f_E(\epsilon))=f_V(\nu)$); and
\item $\up_1(\epsilon)=\top$ (resp., $\lo_1(\epsilon)=\bot$) if and only if $\up_2(f_E(\epsilon))=\top$ (resp., $\lo_2(f_E(\epsilon))=\bot$).
\end{itemize}
\end{definition}
%---------------

%---------------
\begin{notation}
We extend the double-line notation to collections of isomorphic flows. For example, for $n\ge0$; $\boldsymbol{\epsilon}=\epsilon_1,\dots,\epsilon_n$; $\boldsymbol{\epsilon'}=\epsilon'_1,\dots,\epsilon'_n$; and $\boldsymbol{\epsilon''}=\epsilon''_1,\dots,\epsilon''_n$, the following diagrams represent the same flow:
\[
\atomicflow
{
(-9,0)*{\invisiblemark};
(-6,0)*{\afvjum8{\boldsymbol{\epsilon}}{}};
(-4,4)*{\afaidnw{}{}};
( 0,0)*{\afacdm{}{}{}{}{\boldsymbol{\epsilon'}}{}};
( 4,4)*{\afaidnw{}{}};
( 6,0)*{\afvjum8{}{\boldsymbol{\epsilon''}}};
( 9,0)*{\invisiblemark};
}
\quad\mbox{and}\quad
\atomicflow
{
(-9,0)*{\invisiblemark};
(-6,0)*{\afvju8{\epsilon_1}{}};
(-4,4)*{\afaidnw{}{}};
( 0,0)*{\afacd{}{}{}{}{\epsilon'_1}{}};
( 4,4)*{\afaidnw{}{}};
( 6,0)*{\afvju8{}{\epsilon''_1}};
( 9,0)*{\invisiblemark};
}
\quad\cdots\quad
\atomicflow
{
(-9,0)*{\invisiblemark};
(-6,0)*{\afvju8{\epsilon_n}{}};
(-4,4)*{\afaidnw{}{}};
( 0,0)*{\afacd{}{}{}{}{\epsilon'_n}{}};
( 4,4)*{\afaidnw{}{}};
( 6,0)*{\afvju8{}{\epsilon''_n}};
( 9,0)*{\invisiblemark};
}\quad.
\]
\end{notation}
%---------------


%-----------------------------------------------------
\begin{notation}\label{notation:LabelsIsomorphicFlows}
Given an atomic flow
\[
\atomicflow
{
(0, 6)*{\afvjdm4{\boldsymbol\epsilon}{}};
(0, 0)*{\affr88};
(4, 2)*{\aflabelleft{\phi}};
(0,-6)*{\afvjum4{\boldsymbol\iota}{}};
}
\quad,
\]
and a flow $\psi$ which is isomorphic to $\phi$, whenever we write
\[
\psi\;=\;
\atomicflow
{
(0, 6)*{\afvjdm4{f(\boldsymbol\epsilon)}{}};
( 0, 0)*{\affr88};
(4, 2)*{\aflabelleft{f(\phi)}};
(0,-6)*{\afvjum4{f(\boldsymbol\iota)}{}};
}
\quad,
\]
we mean that $f$ is a given flow isomorphism between $\phi$ and $\psi$.
\end{notation}
%-------------

%----------------------------------------------
\begin{convention}\label{convention:EqualFlows}
We consider atomic flows to be equal modulo flow isomorphisms and modulo the equivalence relation generated by the following graph rewriting system:
\[
\atomicflow
{
(-2,2.5)*{\afacdnw{\one}{}{\two}{}};
(0,-2)*{\afacd{}{}{}{}{\four}{}};
(2,4.35)*{\afvjd{4.6}{\three}{}}
}\quad\rightarrow\quad
\atomicflow
{
(2,2.5)*{\afacdnw{\two}{}{\three}{}};
(0,-2)*{\afacd{}{}{}{}{\four}{}};
(-2,4.35)*{\afvjd{4.6}{\one}{}}
}\quad,\qquad
\atomicflow
{
(-2,-4.5)*{\afacunw{\two}{}{\three}{}};
(0,2)*{\afacu{}{}{}{}{\one}{}};
(2,-4.35)*{\afvju{4.6}{\four}{}}
}\quad\rightarrow\quad
\atomicflow
{
(2,-4.5)*{\afacunw{\three}{}{\four}{}};
(0,2)*{\afacu{}{}{}{}{\one}{}};
(-2,-4.35)*{\afvju{4.6}{\two}{}}
}\quad.
\]
\end{convention}
%---------------

%---------------
\begin{notation}
Given an atomic flow $\phi$ and a polarity assignment $\pi$ for $\phi$, whenever we write
\[
\atomicflow{
( 0,6)*{\afvjum4{}{}};
( 0,0)*{\affr88};
(-4,2)*{\aflabelright\ppl};
( 4,2)*{\aflabelleft\phi};
( 0,-6)*{\afvjdm4{}{}};
}\qquad\mbox{or}\qquad
\atomicflow{
( 0,6)*{\afvjum4{}{}};
( 0,0)*{\affr88};
(-4,2)*{\aflabelright\pmi};
( 4,2)*{\aflabelleft\phi};
( 0,-6)*{\afvjdm4{}{}};
}\quad,
\]
respectively, we mean that all the edges in $\phi$ have polarity assignment $\ppl$ or $\pmi$, respectively. If we label an atomic flow with a polarity assignment it can not contain any interaction or cut vertices duo to property~\ref{definition:AtomicFlow:item:PolarityAssignment} of Definition~\vref{definition:AtomicFlow}.
\end{notation}
%-------------

%-----------------
\begin{definition}
Given an atomic flow $\phi$ and a polarity assignment $\pi$ for $\phi$, the polarity assignment $\bar\pi$ for $\phi$ is defined to be, for every $\epsilon$ in $\phi$:
\[
\bar\pi(\epsilon)=
\begin{cases}
\pmi & \mbox{if $\pi(\epsilon)=\ppl$,}
\\
\ppl & \mbox{otherwise.}
\end{cases}
\]
\end{definition}
%---------------

%=======================================================
\subsection{Paths}\label{subsection:Paths}

We now define the notion of `path' in atomic flows. Paths are sequences of adjacent edges that only `go down' or only `go up'.

%---------------------------------------
\begin{definition}\label{definition:FlowPaths}
Given an atomic flow $(V,E,\eta,\up,\lo)$ and $\epsilon_1,\dots,\epsilon_h\in E$ such that, for $1\le i<h$, we have $\lo(\epsilon_i)=\up(\epsilon_{i+1})$, $\up(\epsilon_1)=\nu$ and $\lo(\epsilon_h)=\nu'$, we say that $\epsilon_1,\dots,\epsilon_h$ is a \emph{path from $\nu$ to $\nu'$}\index{path} and that $\epsilon_h,\dots,\epsilon_1$ is a \emph{path from $\nu'$ to $\nu$}; both paths have \emph{length} $h$\index{path!length}.
\end{definition}

%---------------------------------------
\begin{example}\label{example:Paths}
The atomic flow on the left has the paths on the right:
\[
\begin{array}{@{}c@{}c@{}}
\atomicflow{
( 2  ,10)*{\afaidnw{}{}};
( 0  , 6)*{\afvju8\one{}};
( 6  , 6)*{\afacd\two{}\three{}\four{}};
( 8  ,10)*{\afawdnw{}{}};
(10  , 6)*{\afvjd8{}\five};
( 8  , 0)*{\afaiunw{}{}};
(-1.5, 0)*{\invisiblemark};
(11.5, 0)*{\invisiblemark}}
\qquad&
\begin{array}{@{}lllll@{}}
\one                 &                &                  &           &       \\
                     &\two            &\three            &           &       \\
                     &\two,\four      &\three,\four      &\four      &       \\
                     &                &                  &           &\five  \\
\end{array}\quad.
\\
\end{array}
\]
In addition, the flow has the paths obtained from the shown ones by inverting the order of edges, for example $\four,\three$ is a path. The paths from the interaction vertex are $\one$ and $\two$ and $\two,\four$; the paths to the contraction vertex are $\two$ and $\three$ and $\four$.
\end{example}

%=========================================
\subsection{Subflows}\label{subsection:Subflows}

\TODO{Give examples.}

%-------------------------------------------
\begin{definition}\label{definition:Subflow}
We say that the flow $\phi_1=(V_1,E_1,\eta_1,\up_1,\lo_1)$ is a \emph{subflow}\index{subflow} of\newline $\phi_2=(V_2,E_2,\eta_2,\up_2,\lo_2)$, if
\begin{itemize}
\item $V_1\subset V_2$;
\item $E_1\subset E_2$;
\item $\eta_1=\eta_2|_{V_1}$;
\item for every $\epsilon$ in $E_1$
\[
\up_1(\epsilon)=
\begin{cases}
\up_2(\epsilon) & \mbox{if $\up_2(\epsilon)\in V_1$,}
\\
\top & \mbox{otherwise.}
\end{cases}
\qquad\mbox{and}\qquad
\lo_1(\epsilon)=
\begin{cases}
\lo_2(\epsilon) & \mbox{if $\lo_2(\epsilon)\in V_1$,}
\\
\bot & \mbox{otherwise.}
\end{cases}\quad;
\]
\item if $\nu$ is a vertex in $\phi_1$ then $U_\nu$ and $L_\nu$ are subsets of $E_1$; and
\item
if $\nu_1$ and $\nu_2$ are vertices in $\phi_1$, and there is a vertex $\nu'$ in $\phi_2$, such that there are paths from $\nu_1$ to $\nu'$ and from $\nu'$ to $\nu_2$ in $\phi_2$, then $\nu'$ is a vertex in $\phi_1$.
\end{itemize}
\end{definition}
%---------------

%--------------------------------------------------
\begin{definition}\label{defintion:IsolatedSubflow}
Given two flows $\phi$ and $\psi$, such that $\phi$ is a subflow of $\psi$, we say that \emph{$\phi$ is an isolated subflow of $\psi$}\index{subflow!isolated} if there is no path in $\phi$ from a vertex in $\psi$ to $\top$ or $\bot$.
\end{definition}
%---------------

%------------------------------------------------------
\begin{definition}\label{definition:ConnectedComponent}
Given two flows $\phi$ and $\psi$, such that $\phi$ is a subflow of $\psi$, we say that \emph{$\phi$ is a connected component of $\psi$}\index{connected component} if, for any two polarity assignments $\pi$ and $\pi'$ for $\psi$ and for any two edges $\epsilon$ and $\epsilon'$ in $\phi$, $\pi(\epsilon)=\pi(\epsilon')$ if and only if $\pi'(\epsilon)=\pi'(\epsilon')$.
\end{definition}
%---------------